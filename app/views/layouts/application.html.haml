!!! 5
%html{:lang => "en"}
  %head
    %meta{"charset" => "utf-8"}
    %meta{"http-equiv" => "X-UA-Compatible", "content" => "IE=Edge,chrome=1"}
    %meta{"name" => "viewport", "content" => "width=device-width, initial-scale=1.0"}
    %title= content_for?(:title) ? yield(:title) : "Recordiet"
    = csrf_meta_tags
    
    / Le HTML5 shim, for IE6-8 support of HTML elements
    /[if lt IE 9]
      %script{"src" => "http://html5shim.googlecode.com/svn/trunk/html5.js", "type" => "text/javascript"}
    
    = stylesheet_link_tag "application", :media => "all"
  
  %body
    .navbar.navbar-fixed-top.navbar-inverse
      .navbar-inner
        .container
          %a.btn.btn-navbar{"data-target" => ".nav-collapse", "data-toggle" => "collapse"}
            - 3.times do
              %span.icon-bar
          %a.brand{"href" => "#"} Recordiet
          .container.nav-collapse
            %ul.nav
              %li= link_to "体重履歴", weight_logs_path
              %li= link_to "目標達成履歴", achieved_milestone_logs_path
              = render "usermenu"
    .container
      .row
        .span9
          %h2= page_title(controller)
          - if notice
            = render :partial => "notice", :object => notice
          = yield
        .span3
          .well.sidebar-nav
            - user_sidebar_display = User.find(current_user.id)
            %h3{:id => "user_information_area"}
              .btn-group
                %a.btn.dropdown-toggle{"data-toggle" => "dropdown"}
                  %i.icon-user
                  %span.caret
                %ul.dropdown-menu= render "usermenu"
              = user_sidebar_display.display_name
            - if user_sidebar_display.milestone
              %h4{:id => "milestone_area"}
                .btn-group
                  %a.btn.dropdown-toggle{"data-toggle" => "dropdown"}
                    %i.icon-flag
                    %span.caret
                  %ul.dropdown-menu
                    %li= link_to "目標変更", edit_milestone_path
                    %li= link_to "目標削除", milestone_path, method: :delete, data: { confirm: application_message(:confirm_delete) }
                目標
              %div
                - unless user_sidebar_display.weight_logs.empty?
                  = format("あと %s kg",
                           (user_sidebar_display.weight_logs[0].weight - user_sidebar_display.milestone.weight).round(2).to_s)
              %div
                - unless user_sidebar_display.weight_logs.empty?
                  - if user_sidebar_display.milestone.fat_percentage and user_sidebar_display.weight_logs[0].fat_percentage
                    = format("あと %s %",
                             (user_sidebar_display.weight_logs[0].fat_percentage - user_sidebar_display.milestone.fat_percentage).round(2).to_s)
              %div
                - if user_sidebar_display.milestone.date
                  = format("あと %d 日", (user_sidebar_display.milestone.date - Date.today).to_i)
            - else
              %h4{:id => "milestone_area"}
                目標
                = link_to "目標を設定する", new_milestone_path, :class => "btn"
      %footer
        %p &copy; Shinsuke Abe 2012
      
      /
        Javascripts
        ==================================================
        Placed at the end of the document so the pages load faster
      = javascript_include_tag "application"
